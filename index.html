<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>Baisés Volés</title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta name="keywords" content="poem, generator" />
  <meta name="date" content="2013-10-09" />
  <style type="text/css">a:link {text-decoration:none;}</style>
</head>
<body style="font-family: Helvetica, 'Nimbus Sans L', 'Liberation Sans', Arial, sans-serif; background:white; color:black; margin-top:150px; padding:14px 28px 0 28px">
<!-- <div style="text-align:center; font-size:15px; padding: 14px 0 28px 0;"><b style="font-size:20px">Upstart,</b> the morphological productivity of tomorrow, today. By <a href="http://nickm.com">Nick Montfort.</a></div> -->
<div style="width:900px; height: 400px; font-size:36px; margin: 0 auto;">

<div id="dotcom1" style="text-align:center; height:250px; width:300px; line-height:50px; color:white; float:left">
     <video width="300px" height="250px">
    </video> 
    <span id="txtBox1" style="text-align:center; margin-top:25px; padding:5px; background-color:black; height:5px; width:300px;"></span>

</div>


<div id="dotcom2" style="text-align:center; height:25px; width:300px; line-height:50px; color:white;float:right">
    <video width="300px" height="250px">
    </video> 
    <span id="txtBox2" style="text-align:center; background-color:black; padding:5px; height:50px; width:300px;"></span>
</div>


<div id="dotcom3" style="text-align:center; height:250px; width:300px; line-height:50px; color:white; float:left; margin-bottom:500px">
    <video width="300px" height="250px" style:"margin-bottom: 5px">
    </video> 
    <span id="txtBox3" style="text-align:center; margin-top:125px; background-color:black; padding:5px; height:50px; width:300px;">
    </span>
</div>

<div class="override" style="height:100%; width:100%; position:fixed; top:0; left:0; display:none">
    <video id="clip" width="100%" height="100%" z-index="1">
        <source></source>
    </video> 
</div>

<div style="height:28px; clear:both"></div>
<div id="dotcom4" style="text-align:center; height:250px; width:300px; line-height:250px; color:white; float:right; margin-bottom: 28px">
    <video width="300px" height="250px">
    </video> 
    <span id="txtBox4" style="text-align:center; margin-top:125px; background-color:black; height:50px; width:300px;">
    </span>
</div>
</div>

<a href="#" class="start" style="position: absolute; left: 0; top: 0; right: 0; bottom: 0; background: #000; font-size: 60px; text-align: center; color: #fff; text-decoration: none; display: flex; align-items: center; justify-content: center;">
    <span style="">Click to start</span>
</a>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
<script type="text/javascript">


var firstNames = ['Antoine', 'Christine', 'Fabienne'];
var secondNames = ['Doisnel', 'Darbon', 'Tabard']; 
   
function rand_index(len) {
    return Math.floor(Math.random() * len);
}

function update(panel) {
    "use strict"; 
    var dotcomdiv = document.getElementById('dotcom' + panel);
    var firstName = firstNames[rand_index(firstNames.length)];
    var secondName = secondNames[rand_index(secondNames.length)];
    return getImage(firstName + ' ' + secondName, panel);
}

function getImage(query,panel) {
    var dotcomdiv = document.getElementById('dotcom' + panel);
    var text = document.getElementById('txtBox' + panel);
    text.innerHTML = query;
    var video = $('#dotcom'+panel).find('video');
    video.find('source').remove();
    var source = document.createElement('source');
    
    if(query == 'Antoine Doisnel') {
        source.setAttribute('src', 'video/adoisnel.mp4');
        video.append(source);
        return video.get(0);
    } else if (query == 'Christine Darbon') {
        source.setAttribute('src', 'video/cdarbon.mp4');
        video.append(source);
        return video.get(0);
    } else if (query == 'Fabienne Tabard') {
        source.setAttribute('src', 'video/ftabard.mp4');
        video.append(source);
        return video.get(0);
    }
}

function watchVideo(video) {
    if (video) {
        numberOfPlayingVideos++;
        video.onended = function(){
            
            video.pause();
            video.removeAttribute('src'); // empty source
            $(video).find('source').remove();
            video.load();

            numberOfPlayingVideos--;
            if (numberOfPlayingVideos == 0) {
                 init();
            }
        };
        video.play();  
    }
}

var video1, video2, video3, numberOfPlayingVideos;

function init() {
    $('.start').remove();
    video1=update(1);
    video2=update(2);
    video3=update(3);

    numberOfPlayingVideos=0;

    watchVideo(video1);
    watchVideo(video2);
    watchVideo(video3);

    if (numberOfPlayingVideos==0){
        setTimeout(function(){ 
            init();
        },1000);
    }    
}

$('.start').on("click", init);


// $('video').on("click",function(){
//     $('.override').show();
//     $('.override').find("source").attr("src", $(this).find("source").attr("src") );
//     $('.override').find("video").load();
// });
// $('.override').on("click",function(){
//     $('.override').hide();
// });
</script>
</body>
</html>
